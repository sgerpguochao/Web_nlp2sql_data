# 快速启动指南

## 3 步快速启动

### 1️⃣ 激活 Conda 环境并安装依赖

```bash
# 激活 conda 环境（文档推荐）
conda activate web_sql

# 进入项目目录
cd G:\my_vana_cc\Web_nlp2sql_data

# 安装后端依赖（首次需要）
cd backend
pip install -r backend_requirements.txt

# 安装前端依赖（首次需要）
cd ../frontend
npm install
```

### 2️⃣ 启动后端

```bash
# 确保在 web_sql 环境中
cd backend
python app.py
```

成功时看到：
```
[OK] NL2SQL API server starting...
API: http://0.0.0.0:8000/api
WebSocket: ws://0.0.0.0:8000/ws
Health: http://0.0.0.0:8000/health
Docs: http://0.0.0.0:8000/docs
```

### 3️⃣ 启动前端（新终端）

```bash
cd G:\my_vana_cc\Web_nlp2sql_data\frontend
npm run dev
```

### 4️⃣ 访问 Web 界面

打开浏览器访问：`http://localhost:3000`

局域网访问：`http://你的IP:3000`（已配置 0.0.0.0，任意客户端可访问）

---

## Windows 一键启动（推荐）

### 方式一：分别启动

- **start_backend.bat**：启动后端（自动激活 conda web_sql）
- **start_frontend.bat**：启动前端

### 方式二：同时启动前后端

- **start_all.bat**：一键打开两个窗口，分别运行后端和前端

---

## 完整使用流程

配置 → 测试 → 生成 → 下载

1. **配置数据库**：填写 MySQL 连接信息，点击「测试连接」
2. **配置模型**：填写 LLM API 信息，点击「测试连接」
3. **设置参数**：选择格式（Alpaca）、样本数（建议先测 100）
4. **开始生成**：点击「开始生成」
5. **实时监控**：查看 6 步进度和实时日志
6. **下载数据**：完成后点击「下载数据」或从 `backend/data/nl2sql.jsonl` 获取

---

## 数据输出位置

```
backend/data/
├── nl2sql.jsonl          # 最终训练数据（重要）
├── metadata.json         ← 数据库元数据
├── table_cards.json      ← 表卡片
├── plan.json             ← 主题规划
├── samples_raw.jsonl     ← 原始样本
└── samples_valid.jsonl   ← 验证通过的样本
```

---

## 使用脚本启动（Linux/macOS）

```bash
./scripts/start_backend.sh
```

脚本会：检测 conda、激活 web_sql、检查依赖、启动后端。

---

## 常见问题

### 问题 1：ModuleNotFoundError

```bash
conda activate web_sql
pip install -r backend_requirements.txt
```

### 问题 2：端口被占用

```bash
# Windows 查看占用
netstat -ano | findstr :8000

# 换端口启动
set PORT=8001
python app.py
```

### 问题 3：前端无法连接后端

1. 确认后端已启动：访问 `http://localhost:8000/health`
2. 查看浏览器控制台错误
3. 检查防火墙设置

---

## 验证安装

```bash
conda activate web_sql
python -c "import fastapi, uvicorn, pymysql, openai, sqlglot; print('OK: all deps installed')"
```

---

## 更多文档

- [INSTALL_CONDA.md](INSTALL_CONDA.md) - Conda 安装指南
- [WEB_USAGE.md](WEB_USAGE.md) - Web 界面使用
- [API.md](API.md) - API 接口文档
