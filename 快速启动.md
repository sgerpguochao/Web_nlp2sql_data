# 🚀 快速启动指南（Conda版）

## ⚡ 3步快速启动

### 1️⃣ 激活Conda环境并安装依赖

```bash
# 激活您的conda环境
conda activate web_sql

# 进入项目目录
cd /Users/baierfa/Documents/muyan/大模型微调/Ch11_sql微调/Web_shargpt

# 安装后端依赖（首次需要）
pip install -r backend_requirements.txt
```

### 2️⃣ 启动后端

```bash
# 确保在web_sql环境中
python app.py
```

✅ 看到这个说明成功：
```
🚀 NL2SQL数据生成系统API服务器启动
📍 API地址: http://0.0.0.0:8000/api
📍 API文档: http://0.0.0.0:8000/docs
```

### 3️⃣ 启动前端（新终端）

```bash
cd /Users/baierfa/Documents/muyan/大模型微调/Ch11_sql微调/Web_shargpt

# 启动前端（首次需要先 npm install）
npm run dev
```

### 4️⃣ 访问Web界面

打开浏览器访问显示的地址（通常是 `http://localhost:3000`）

---

## 📋 完整流程

### 配置 → 测试 → 生成 → 下载

1. **配置数据库**：填写MySQL连接信息，点击"测试连接"
2. **配置模型**：填写LLM API信息，点击"测试连接"  
3. **设置参数**：选择格式（Alpaca）、样本数（100）
4. **开始生成**：点击"开始生成"按钮
5. **实时监控**：查看6步进度和实时日志
6. **下载数据**：完成后点击"下载数据"或从 `data/nl2sql.jsonl` 获取

---

## 📥 数据位置

生成的文件在：
```
Web_shargpt/data/
├── nl2sql.jsonl          ← 最终训练数据（重要！）
├── metadata.json         ← 数据库元数据
├── table_cards.json      ← 表卡片
├── plan.json             ← 主题规划
├── samples_raw.jsonl     ← 原始样本
└── samples_valid.jsonl   ← 验证通过的样本
```

---

## 💡 使用脚本启动（推荐）

### 一键启动后端（自动激活conda）

```bash
./scripts/start_backend.sh
```

脚本会：
- ✅ 自动检测conda环境
- ✅ 激活web_sql环境
- ✅ 检查并安装依赖
- ✅ 启动后端服务

---

## ⚠️ 如果遇到问题

### 问题1：ModuleNotFoundError

```bash
# 确认在正确的conda环境中
conda activate web_sql

# 重新安装依赖
pip install -r backend_requirements.txt
```

### 问题2：端口被占用

```bash
# 查看占用
lsof -i :8000

# 杀掉进程或换端口
export PORT=8001
python app.py
```

### 问题3：前端无法连接后端

1. 确认后端启动成功：`http://localhost:8000/health`
2. 查看浏览器控制台错误信息
3. 检查防火墙设置

---

## 📚 更多文档

- [INSTALL_CONDA.md](INSTALL_CONDA.md) - 详细的Conda安装指南
- [WEB_USAGE.md](WEB_USAGE.md) - Web界面使用指南
- [API.md](API.md) - API接口文档

---

## ✅ 验证安装

```bash
conda activate web_sql
python -c "import fastapi, uvicorn, pymysql, openai, sqlglot; print('✅ 所有依赖已安装')"
```

---

**现在开始使用吧！** 🎉

