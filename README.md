# NL2SQLè‡ªåŠ¨åŒ–æ•°æ®ç”Ÿæˆç³»ç»Ÿ

> âœ… **å‰åç«¯å·²å®Œå…¨é›†æˆ** - çœŸå®æ•°æ®ç”Ÿæˆ | å®æ—¶è¿›åº¦è¿½è¸ª | é…ç½®ä¿å­˜ | æ•°æ®ä¸‹è½½

ä¼ä¸šçº§NL2SQLè®­ç»ƒæ•°æ®è‡ªåŠ¨ç”Ÿæˆå·¥å…·ï¼Œæ”¯æŒä¸¤é˜¶æ®µLLMç”Ÿæˆæ¶æ„ï¼Œæä¾›Webç•Œé¢å’Œå‘½ä»¤è¡Œä¸¤ç§ä½¿ç”¨æ–¹å¼ã€‚

## ğŸ‰ æœ€æ–°æ›´æ–°

**å‰åç«¯å®Œå…¨è¿æ¥ï¼Œç°åœ¨æ”¯æŒï¼š**

- âœ… **çœŸå®APIè°ƒç”¨** - ä¸å†æ˜¯æ¼”ç¤ºæ•°æ®ï¼ŒçœŸæ­£è¿æ¥åç«¯ç”Ÿæˆ
- âœ… **å®æ—¶WebSocket** - ç”Ÿæˆè¿›åº¦ã€æ—¥å¿—å®æ—¶æ¨é€
- âœ… **è¿æ¥æµ‹è¯•** - ä¸€é”®æµ‹è¯•æ•°æ®åº“å’ŒLLMè¿æ¥
- âœ… **é…ç½®ä¿å­˜** - è‡ªåŠ¨ä¿å­˜é…ç½®ï¼Œä¸‹æ¬¡ä½¿ç”¨æ— éœ€é‡æ–°å¡«å†™
- âœ… **æ•°æ®ä¸‹è½½** - ç”Ÿæˆå®Œæˆåä¸€é”®ä¸‹è½½ç»“æœæ–‡ä»¶

**ğŸ“š è¯¦ç»†æ–‡æ¡£ï¼š**
- [å‰åç«¯è¿æ¥è¯´æ˜](./å‰åç«¯è¿æ¥è¯´æ˜.md) - æŠ€æœ¯æ¶æ„å’Œè°ƒè¯•æŒ‡å—
- [æµ‹è¯•æŒ‡å—](./æµ‹è¯•æŒ‡å—.md) - å®Œæ•´çš„æµ‹è¯•æµç¨‹å’Œé—®é¢˜æ’æŸ¥

## ç³»ç»Ÿç‰¹æ€§

- âœ… **ä¸¤é˜¶æ®µç”Ÿæˆ**ï¼šå…ˆè§„åˆ’ä¸»é¢˜ï¼Œå†ç”Ÿæˆæ ·æœ¬ï¼Œç¡®ä¿æ•°æ®è´¨é‡å’Œè¦†ç›–åº¦
- âœ… **å¤šæ•°æ®åº“æ”¯æŒ**ï¼šæ”¯æŒMySQLã€PostgreSQLã€SQL Server
- âœ… **å¤šæ¨¡å‹å…¼å®¹**ï¼šOpenAIå…¼å®¹æ¥å£ï¼Œæ”¯æŒQwenã€DeepSeekã€ChatGLMç­‰
- âœ… **è‡ªåŠ¨éªŒè¯**ï¼šSQLè¯­æ³•æ£€æŸ¥ + SchemaéªŒè¯ + å¯é€‰æ‰§è¡ŒéªŒè¯
- âœ… **å¤šæ ¼å¼å¯¼å‡º**ï¼šæ”¯æŒAlpacaå’ŒShareGPTæ ¼å¼ï¼Œå¯ç›´æ¥ç”¨äºLLaMA-Factoryå¾®è°ƒ
- âœ… **Webç•Œé¢**ï¼šç°ä»£åŒ–çš„Webç•Œé¢ï¼Œå®æ—¶æ˜¾ç¤ºè¿›åº¦å’Œæ—¥å¿—
- âœ… **å®Œæ•´æ—¥å¿—**ï¼šæ¯ä¸ªé˜¶æ®µéƒ½æœ‰è¯¦ç»†æ—¥å¿—è®°å½•

## ç³»ç»Ÿæ¶æ„

```
æ•°æ®åº“ â†’ å…ƒæ•°æ®æå– â†’ è¡¨å¡ç‰‡ç”Ÿæˆ â†’ LLMè§„åˆ’(é˜¶æ®µA) â†’ LLMç”Ÿæˆ(é˜¶æ®µB) â†’ SQLéªŒè¯ â†’ å¯¼å‡ºè®­ç»ƒæ•°æ®
```

### æ ¸å¿ƒæ¨¡å—

1. **Metadata Extractor**ï¼šæå–æ•°æ®åº“è¡¨ç»“æ„ã€å­—æ®µã€ä¸»å¤–é”®ç­‰å…ƒæ•°æ®
2. **Table Cards Generator**ï¼šç”Ÿæˆç®€åŒ–çš„è¡¨å¡ç‰‡æ‘˜è¦ï¼Œä¾¿äºLLMç†è§£
3. **Planner (LLMé˜¶æ®µA)**ï¼šåŸºäºè¡¨å¡ç‰‡ï¼Œè§„åˆ’ä¸šåŠ¡ä¸»é¢˜å’Œè¡¨é›†åˆ
4. **Generator (LLMé˜¶æ®µB)**ï¼šåŸºäºä¸»é¢˜å’ŒDDLï¼Œç”ŸæˆNL+SQLæ ·æœ¬
5. **SQL Validator**ï¼šéªŒè¯SQLè¯­æ³•å’ŒSchemaæ­£ç¡®æ€§
6. **Data Exporter**ï¼šå¯¼å‡ºä¸ºLLaMA-Factoryå¯ç”¨æ ¼å¼

## å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šä½¿ç”¨Webç•Œé¢ï¼ˆæ¨èï¼‰

#### 1. å®‰è£…ä¾èµ–

```bash
# å®‰è£…åç«¯ä¾èµ–
pip install -r backend_requirements.txt

# å®‰è£…å‰ç«¯ä¾èµ–
npm install
```

#### 2. å¯åŠ¨æœåŠ¡

**æ–¹æ³•Aï¼šåŒæ—¶å¯åŠ¨å‰åç«¯**
```bash
./scripts/start_all.sh
```

**æ–¹æ³•Bï¼šåˆ†åˆ«å¯åŠ¨**
```bash
# ç»ˆç«¯1ï¼šå¯åŠ¨åç«¯APIæœåŠ¡å™¨
./scripts/start_backend.sh

# ç»ˆç«¯2ï¼šå¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨
./scripts/start_frontend.sh
```

#### 3. è®¿é—®Webç•Œé¢

æ‰“å¼€æµè§ˆå™¨è®¿é—®: `http://localhost:3000`

#### 4. ä½¿ç”¨Webç•Œé¢

1. **é…ç½®æ•°æ®åº“**ï¼šå¡«å†™æ•°æ®åº“è¿æ¥ä¿¡æ¯ â†’ ç‚¹å‡»"æµ‹è¯•è¿æ¥" â†’ ç­‰å¾… âœ… è¿æ¥æˆåŠŸ
2. **é…ç½®LLM**ï¼šå¡«å†™LLM APIä¿¡æ¯ â†’ ç‚¹å‡»"æµ‹è¯•LLMè¿æ¥" â†’ ç­‰å¾… âœ… è¿æ¥æˆåŠŸ
3. **è®¾ç½®å‚æ•°**ï¼šé€‰æ‹©SQLæ–¹è¨€ã€æ•°æ®æ ¼å¼ã€æ ·æœ¬æ•°é‡ï¼ˆå»ºè®®å…ˆæµ‹è¯•10æ¡ï¼‰
4. **å‹¾é€‰ä¿å­˜é…ç½®**ï¼šä¸‹æ¬¡ä½¿ç”¨è‡ªåŠ¨å¡«å……
5. **å¼€å§‹ç”Ÿæˆ**ï¼šç‚¹å‡»"å¼€å§‹ç”Ÿæˆ"
6. **å®æ—¶ç›‘æ§**ï¼šå³ä¾§é¢æ¿æ˜¾ç¤ºå®æ—¶è¿›åº¦å’Œæ—¥å¿—ï¼ˆçœŸå®æ•°æ®ï¼Œéæ¨¡æ‹Ÿï¼‰
7. **ä¸‹è½½ç»“æœ**ï¼šç”Ÿæˆå®Œæˆåç‚¹å‡»"ä¸‹è½½æ•°æ®"æŒ‰é’®

**éªŒè¯ç³»ç»Ÿæ˜¯å¦æ­£å¸¸ï¼š**
```bash
# è¿è¡Œé›†æˆéªŒè¯è„šæœ¬
./scripts/verify_integration.sh
```

#### 5. ç”Ÿäº§éƒ¨ç½²

æ„å»ºå‰ç«¯å¹¶éƒ¨ç½²ï¼š
```bash
# æ„å»ºå‰ç«¯
./scripts/build_and_deploy.sh

# å¯åŠ¨åç«¯ï¼ˆç”Ÿäº§æ¨¡å¼ï¼‰
python app.py
```

è®¿é—®: `http://localhost:8000`

---

### æ–¹å¼äºŒï¼šä½¿ç”¨å‘½ä»¤è¡Œ

#### 1. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

#### 2. é…ç½®ç³»ç»Ÿ

ç¼–è¾‘ `config.yaml`ï¼š

```yaml
# æ•°æ®åº“é…ç½®
db:
  type: "mysql"
  host: "127.0.0.1"
  port: 3306
  user: "root"
  password: "your_password"
  database: "your_database"

# LLMé…ç½®
llm:
  api_base: "http://127.0.0.1:8000/v1"
  api_key: "sk-xxxx"
  model_name: "qwen2.5-7b-instruct"
  temperature: 0.7

# ç”Ÿæˆé…ç½®
generate:
  total_samples: 500
  dialect: "mysql"
  output_path: "./data/nl2sql.jsonl"
  output_format: "alpaca"  # æˆ– "sharegpt"
```

#### 3. è¿è¡Œç”Ÿæˆ

```bash
python auto_nl2sql.py --config config.yaml
```

---

## ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬ä½¿ç”¨

```bash
# ä½¿ç”¨é…ç½®æ–‡ä»¶
python auto_nl2sql.py --config config.yaml
```

### å‘½ä»¤è¡Œå‚æ•°è¦†ç›–

```bash
# è¦†ç›–é…ç½®æ–‡ä»¶ä¸­çš„å‚æ•°
python auto_nl2sql.py \
  --config config.yaml \
  --total_samples 1000 \
  --output_format sharegpt \
  --db_database sales
```

### å®Œæ•´å‘½ä»¤è¡Œå‚æ•°

```bash
python auto_nl2sql.py \
  --db_host 127.0.0.1 \
  --db_port 3306 \
  --db_user root \
  --db_password 123456 \
  --db_database sales \
  --llm_api_base http://127.0.0.1:8000/v1 \
  --llm_api_key sk-xxxx \
  --llm_model qwen2.5-7b-instruct \
  --total_samples 500 \
  --output_path ./data/nl2sql.jsonl \
  --output_format alpaca
```

### è·³è¿‡SQLéªŒè¯ï¼ˆåŠ å¿«é€Ÿåº¦ï¼‰

```bash
python auto_nl2sql.py --config config.yaml --skip_validation
```

## è¾“å‡ºæ–‡ä»¶

è¿è¡Œåä¼šåœ¨ `data/` ç›®å½•ä¸‹ç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ï¼š

```
data/
â”œâ”€â”€ metadata.json          # æ•°æ®åº“å…ƒæ•°æ®
â”œâ”€â”€ table_cards.json       # è¡¨å¡ç‰‡æ‘˜è¦
â”œâ”€â”€ plan.json             # ä¸»é¢˜è§„åˆ’
â”œâ”€â”€ samples_raw.jsonl     # åŸå§‹ç”Ÿæˆæ ·æœ¬
â”œâ”€â”€ samples_valid.jsonl   # éªŒè¯é€šè¿‡çš„æ ·æœ¬
â””â”€â”€ nl2sql.jsonl          # æœ€ç»ˆè®­ç»ƒæ•°æ®
```

## è¾“å‡ºæ ¼å¼

### Alpacaæ ¼å¼

```json
{
  "instruction": "æ ¹æ®ä»¥ä¸‹æ•°æ®åº“è¡¨ç»“æ„ï¼Œå°†è‡ªç„¶è¯­è¨€é—®é¢˜è½¬æ¢ä¸ºSQLæŸ¥è¯¢è¯­å¥ã€‚",
  "input": "æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·çš„å§“åå’Œé‚®ç®±",
  "output": "SELECT name, email FROM users;"
}
```

### ShareGPTæ ¼å¼

```json
{
  "conversations": [
    {
      "role": "user",
      "content": "æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·çš„å§“åå’Œé‚®ç®±"
    },
    {
      "role": "assistant",
      "content": "SELECT name, email FROM users;"
    }
  ]
}
```

## é«˜çº§é…ç½®

### å®‰å…¨é…ç½®

åœ¨ `config.yaml` ä¸­é…ç½®è¡¨é»‘åå•ï¼š

```yaml
security:
  table_blacklist:
    - "user_password"
    - "admin_users"
  enable_limit: true
  max_limit: 100
```

### å¯ç”¨SQLæ‰§è¡ŒéªŒè¯

```yaml
generate:
  enable_execution_check: true  # å¯ç”¨åä¼šå®é™…æ‰§è¡ŒSQLéªŒè¯
```

âš ï¸ **æ³¨æ„**ï¼šå¯ç”¨æ‰§è¡ŒéªŒè¯ä¼šå®é™…æŸ¥è¯¢æ•°æ®åº“ï¼Œå»ºè®®åœ¨æµ‹è¯•åº“ä¸Šä½¿ç”¨ã€‚

## å·¥ä½œæµç¨‹

### é˜¶æ®µ1ï¼šå…ƒæ•°æ®æå–

ä» `information_schema` æå–æ‰€æœ‰è¡¨çš„ç»“æ„ä¿¡æ¯ï¼š

- è¡¨åã€åˆ—åã€æ•°æ®ç±»å‹
- ä¸»é”®ã€å¤–é”®å…³ç³»
- åˆ—æ³¨é‡Šç­‰

### é˜¶æ®µ2ï¼šè¡¨å¡ç‰‡ç”Ÿæˆ

å°†å¤æ‚çš„å…ƒæ•°æ®è½¬æ¢ä¸ºç®€åŒ–çš„è¡¨å¡ç‰‡æ‘˜è¦ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š

```json
{
  "orders": {
    "summary": "è®¢å•è®°å½•è¡¨ï¼Œè®°å½•ç”¨æˆ·è´­ä¹°ä¿¡æ¯ã€‚",
    "columns": [
      {"name": "order_id", "type": "INT", "desc": "ä¸»é”®"},
      {"name": "user_id", "type": "INT", "desc": "ç”¨æˆ·ID"}
    ],
    "foreign_keys": {"user_id": "users.id"}
  }
}
```

### é˜¶æ®µ3ï¼šä¸»é¢˜è§„åˆ’ï¼ˆLLMé˜¶æ®µAï¼‰

è°ƒç”¨LLMåˆ†æè¡¨å¡ç‰‡ï¼Œç”Ÿæˆä¸šåŠ¡ä¸»é¢˜è§„åˆ’ï¼š

```json
{
  "topics": [
    {
      "name": "ç”¨æˆ·åˆ†æ",
      "tables": ["users", "orders", "products"],
      "reason": "è¿™äº›è¡¨ç»„åˆå¯ä»¥åˆ†æç”¨æˆ·è´­ä¹°è¡Œä¸º",
      "count": 200,
      "dialect": "mysql"
    }
  ]
}
```

### é˜¶æ®µ4ï¼šæ ·æœ¬ç”Ÿæˆï¼ˆLLMé˜¶æ®µBï¼‰

å¯¹æ¯ä¸ªä¸»é¢˜ï¼ŒåŸºäºç›¸å…³è¡¨çš„DDLï¼Œè°ƒç”¨LLMç”Ÿæˆæ ·æœ¬ï¼š

```
æç¤ºè¯ï¼šåŸºäºä»¥ä¸‹è¡¨ç»“æ„ï¼Œç”Ÿæˆ200æ¡å…³äº"ç”¨æˆ·åˆ†æ"çš„NL+SQLæ ·æœ¬
è¡¨ç»“æ„ï¼šCREATE TABLE users (...); CREATE TABLE orders (...);
è¦æ±‚ï¼šSQLå¯æ‰§è¡Œã€ä¸è™šæ„å­—æ®µã€æ ¼å¼ä¸ºJSONè¡Œ
```

### é˜¶æ®µ5ï¼šSQLéªŒè¯

å¯¹ç”Ÿæˆçš„æ ·æœ¬è¿›è¡Œä¸‰å±‚éªŒè¯ï¼š

1. **è¯­æ³•æ£€æŸ¥**ï¼šä½¿ç”¨sqlglotè§£æSQL
2. **SchemaéªŒè¯**ï¼šæ£€æŸ¥è¡¨åå’Œå­—æ®µæ˜¯å¦å­˜åœ¨
3. **æ‰§è¡ŒéªŒè¯**ï¼ˆå¯é€‰ï¼‰ï¼šå®é™…æ‰§è¡ŒSQLæŸ¥è¯¢

### é˜¶æ®µ6ï¼šå¯¼å‡ºæ•°æ®

å°†éªŒè¯é€šè¿‡çš„æ ·æœ¬å¯¼å‡ºä¸ºæŒ‡å®šæ ¼å¼ï¼Œå¹¶è¾“å‡ºç»Ÿè®¡ä¿¡æ¯ã€‚

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

| ä¼˜åŒ–ç‚¹ | è¯´æ˜ |
|--------|------|
| **é™ä½æ ·æœ¬æ•°** | åˆæ¬¡æµ‹è¯•å¯è®¾ç½®ä¸º50-100æ¡ï¼ŒéªŒè¯æµç¨‹åå†å¢åŠ  |
| **è·³è¿‡éªŒè¯** | ä½¿ç”¨ `--skip_validation` å¯æ˜¾è‘—æé€Ÿ |
| **è°ƒæ•´æ¸©åº¦** | `temperature=0.3-0.5` å¯è·å¾—æ›´ç¨³å®šçš„è¾“å‡º |
| **å¢åŠ è¶…æ—¶** | ç½‘ç»œä¸ä½³æ—¶å¢åŠ  `timeout` å€¼ |

## å¸¸è§é—®é¢˜

### 1. LLMè¿”å›éJSONæ ¼å¼

**ç—‡çŠ¶**ï¼šJSONè§£æå¤±è´¥

**è§£å†³**ï¼š
- é™ä½temperature (0.3-0.5)
- åœ¨promptä¸­å¼ºè°ƒ"ä»…è¾“å‡ºJSONï¼Œä¸è¦è§£é‡Š"
- æŸ¥çœ‹æ—¥å¿—ä¸­çš„åŸå§‹LLMå“åº”

### 2. ç”Ÿæˆçš„SQLæ— æ³•æ‰§è¡Œ

**ç—‡çŠ¶**ï¼šéªŒè¯é˜¶æ®µå¤§é‡æ ·æœ¬è¢«è¿‡æ»¤

**è§£å†³**ï¼š
- æ£€æŸ¥è¡¨æ³¨é‡Šæ˜¯å¦å®Œå–„
- åœ¨promptä¸­å¢åŠ ç¤ºä¾‹SQL
- å¯ç”¨æ‰§è¡ŒéªŒè¯æ‰¾å‡ºå…·ä½“é”™è¯¯

### 3. ä¸»é¢˜è§„åˆ’ä¸åˆç†

**ç—‡çŠ¶**ï¼šä¸»é¢˜åˆ†é…çš„è¡¨æ²¡æœ‰å…³è”æ€§

**è§£å†³**ï¼š
- å®Œå–„è¡¨å’Œåˆ—çš„æ³¨é‡Š
- è°ƒæ•´ `min_tables_per_topic` å’Œ `max_tables_per_topic`
- æ‰‹åŠ¨ç¼–è¾‘ `plan.json` åä»é˜¶æ®µ4ç»§ç»­è¿è¡Œ

### 4. è¿æ¥æ•°æ®åº“å¤±è´¥

**ç—‡çŠ¶**ï¼šæ— æ³•è¿æ¥åˆ°MySQL

**è§£å†³**ï¼š
- æ£€æŸ¥æ•°æ®åº“æœåŠ¡æ˜¯å¦è¿è¡Œ
- éªŒè¯ç”¨æˆ·åã€å¯†ç ã€ç«¯å£
- ç¡®è®¤é˜²ç«å¢™å’Œç½‘ç»œé…ç½®

## é¡¹ç›®ç»“æ„

```
Ch11_sqlå¾®è°ƒ/
â”œâ”€â”€ auto_nl2sql.py           # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ config.yaml              # é…ç½®æ–‡ä»¶
â”œâ”€â”€ requirements.txt         # ä¾èµ–åŒ…
â”œâ”€â”€ README.md               # ä½¿ç”¨æ–‡æ¡£
â”œâ”€â”€ modules/                # æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ db_connector.py     # æ•°æ®åº“è¿æ¥å™¨
â”‚   â”œâ”€â”€ metadata_extractor.py  # å…ƒæ•°æ®æå–
â”‚   â”œâ”€â”€ table_cards.py      # è¡¨å¡ç‰‡ç”Ÿæˆ
â”‚   â”œâ”€â”€ llm_client.py       # LLMå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ planner.py          # ä¸»é¢˜è§„åˆ’å™¨
â”‚   â”œâ”€â”€ generator.py        # æ ·æœ¬ç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ validator.py        # SQLéªŒè¯å™¨
â”‚   â””â”€â”€ exporter.py         # æ•°æ®å¯¼å‡ºå™¨
â”œâ”€â”€ data/                   # æ•°æ®è¾“å‡ºç›®å½•
â””â”€â”€ logs/                   # æ—¥å¿—ç›®å½•
```

## Web APIæ¥å£

ç³»ç»Ÿæä¾›å®Œæ•´çš„REST APIå’ŒWebSocketæ¥å£ï¼Œè¯¦ç»†æ–‡æ¡£è¯·æŸ¥çœ‹ï¼š

- **APIæ–‡æ¡£**: `http://localhost:8000/docs` (Swagger UI)
- **è¯¦ç»†è¯´æ˜**: [API.md](API.md)

### ä¸»è¦APIç«¯ç‚¹

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/api/test-db-connection` | POST | æµ‹è¯•æ•°æ®åº“è¿æ¥ |
| `/api/test-llm-connection` | POST | æµ‹è¯•LLMè¿æ¥ |
| `/api/start-generation` | POST | å¯åŠ¨ç”Ÿæˆä»»åŠ¡ |
| `/api/status` | GET | è·å–ä»»åŠ¡çŠ¶æ€ |
| `/api/logs` | GET | è·å–æ—¥å¿— |
| `/api/cancel` | POST | å–æ¶ˆä»»åŠ¡ |

### WebSocketç«¯ç‚¹

| ç«¯ç‚¹ | è¯´æ˜ |
|------|------|
| `/ws/logs` | å®æ—¶æ—¥å¿—æ¨é€ |
| `/ws/progress` | å®æ—¶è¿›åº¦æ¨é€ |
| `/ws/all` | æ‰€æœ‰æ¶ˆæ¯æ¨é€ |

## ä¾èµ–åŒ…

### åç«¯ä¾èµ–
```
fastapi>=0.104.0            # Webæ¡†æ¶
uvicorn>=0.24.0             # ASGIæœåŠ¡å™¨
pymysql>=1.1.0              # MySQLè¿æ¥
openai>=1.0.0               # LLMå®¢æˆ·ç«¯
sqlglot>=20.0.0             # SQLè§£æ
pyyaml>=6.0                 # é…ç½®æ–‡ä»¶
websockets>=12.0            # WebSocketæ”¯æŒ
```

### å‰ç«¯ä¾èµ–
- React + TypeScript
- Vite
- Tailwind CSS
- shadcn/ui ç»„ä»¶åº“

## é¡¹ç›®ç»“æ„ï¼ˆWebç‰ˆï¼‰

```
Web_shargpt/
â”œâ”€â”€ app.py                   # FastAPIä¸»åº”ç”¨
â”œâ”€â”€ backend_requirements.txt # åç«¯ä¾èµ–
â”œâ”€â”€ api/                     # APIæ¨¡å—
â”‚   â”œâ”€â”€ routes.py           # REST APIè·¯ç”±
â”‚   â”œâ”€â”€ websocket.py        # WebSocketå¤„ç†
â”‚   â”œâ”€â”€ task_manager.py     # ä»»åŠ¡ç®¡ç†
â”‚   â””â”€â”€ log_handler.py      # æ—¥å¿—å¤„ç†
â”œâ”€â”€ modules/                 # æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ db_connector.py
â”‚   â”œâ”€â”€ llm_client.py
â”‚   â””â”€â”€ ...
â”œâ”€â”€ src/                     # å‰ç«¯æºç 
â”‚   â”œâ”€â”€ App.tsx
â”‚   â”œâ”€â”€ components/
â”‚   â””â”€â”€ ...
â”œâ”€â”€ scripts/                 # å¯åŠ¨è„šæœ¬
â”‚   â”œâ”€â”€ start_backend.sh
â”‚   â”œâ”€â”€ start_frontend.sh
â”‚   â””â”€â”€ start_all.sh
â”œâ”€â”€ data/                    # æ•°æ®è¾“å‡º
â”œâ”€â”€ logs/                    # æ—¥å¿—æ–‡ä»¶
â””â”€â”€ dist/                    # å‰ç«¯æ„å»ºè¾“å‡º
```

## æŠ€æœ¯æ ˆ

- **åç«¯**: Python 3.8+, FastAPI, asyncio
- **å‰ç«¯**: React 18, TypeScript, Vite
- **æ•°æ®åº“**: MySQL / PostgreSQL / SQL Server
- **LLM**: OpenAIå…¼å®¹API
- **éƒ¨ç½²**: Uvicorn, Nginx (å¯é€‰)

## æ•…éšœæ’æŸ¥

### å‰ç«¯æ— æ³•è¿æ¥åç«¯

1. æ£€æŸ¥åç«¯æ˜¯å¦æ­£å¸¸å¯åŠ¨ï¼šè®¿é—® `http://localhost:8000/health`
2. æ£€æŸ¥å‰ç«¯APIé…ç½®æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥CORSè®¾ç½®

### WebSocketè¿æ¥å¤±è´¥

1. ç¡®è®¤åç«¯WebSocketç«¯ç‚¹æ­£å¸¸ï¼š`ws://localhost:8000/ws/all`
2. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
3. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

### ä»»åŠ¡æ‰§è¡Œå¤±è´¥

1. æŸ¥çœ‹å®æ—¶æ—¥å¿—è¾“å‡º
2. æ£€æŸ¥æ•°æ®åº“è¿æ¥
3. éªŒè¯LLM APIé…ç½®
4. æŸ¥çœ‹åç«¯æ—¥å¿—æ–‡ä»¶ï¼š`logs/`

## æ€§èƒ½å»ºè®®

- **å¼€å‘ç¯å¢ƒ**: ä½¿ç”¨ `start_all.sh` åŒæ—¶å¯åŠ¨å‰åç«¯
- **ç”Ÿäº§ç¯å¢ƒ**: æ„å»ºå‰ç«¯ååªè¿è¡Œåç«¯æœåŠ¡
- **å¤§é‡æ•°æ®**: å»ºè®®åˆ†æ‰¹ç”Ÿæˆï¼Œæ¯æ‰¹100-500æ¡
- **ç½‘ç»œä¼˜åŒ–**: ä½¿ç”¨Nginxåå‘ä»£ç†

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

### å¼€å‘æŒ‡å—

1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ï¼š`git checkout -b feature/new-feature`
3. æäº¤ä¿®æ”¹ï¼š`git commit -am 'Add new feature'`
4. æ¨é€åˆ†æ”¯ï¼š`git push origin feature/new-feature`
5. æäº¤Pull Request

## è®¸å¯è¯

MIT License

## ç›¸å…³æ–‡æ¡£

- [APIæ–‡æ¡£](API.md) - å®Œæ•´çš„APIæ¥å£æ–‡æ¡£
- [å¿«é€Ÿå¼€å§‹](QUICKSTART.md) - å¿«é€Ÿå¼€å§‹æŒ‡å—
- [ç¤ºä¾‹æ•°æ®åº“](example_database.sql) - æµ‹è¯•ç”¨æ•°æ®åº“

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æäº¤Issueæˆ–è”ç³»é¡¹ç›®ç»´æŠ¤è€…ã€‚

---

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼ğŸš€**

